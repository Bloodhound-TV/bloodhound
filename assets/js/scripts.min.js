function clearInput(){$("#add_show").prop("disabled",!1),$("#show_name").val("")}function displayAlert(a,b){alert='<div class="alert alert-'+a+' alert-dismissible" role="alert">',alert+='<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+b+"</div>",$("#alert-container").html(alert)}$(document).ready(function(){$(document).ajaxError(function(a,b){displayAlert("danger","Oh no! '"+b.responseJSON.error)}),$(document).on("click","#add_show",function(){$("#add_show").prop("disabled",!0),show=$("#show_name").val(),$.post("/api/addShowByName",{show:show}).done(function(a){a.error?displayAlert("warning","Oh no! "+a.error):(show=a.show,$newRow=$(".collection-row").last().clone(),$newRow.removeClass(),$newRow.addClass("collection-row"),$newRow.attr("id","show-"+show.show_id),$(".collection-show-name",$newRow).html(show.name),$(".collection-show-button",$newRow).find("button").attr("data-show",show.show_id),$(".collection-show-button",$newRow).find("button").attr("data-name",show.name),$newRow.appendTo("#collection"),displayAlert("success","You've added '"+show.name+"' ("+show.show_id+") to your collection")),clearInput()}).fail(function(){clearInput()})}),$(document).on("click",".remove_show",function(){console.log("remove clicked"),$(this).prop("disabled",!0),show_id=$(this).attr("data-show"),show_name=$(this).attr("data-name"),$.post("/api/removeShow",{show_id:show_id}).done(function(a){a.error?displayAlert("warning","Oh no! "+a.error):"OK"==a.status&&(console.log($(this).parent().parent()),$("#show-"+show_id).remove(),displayAlert("success","You've removed '"+show_name+"' ("+show_id+") from your collection"))})})}),$(document).ready(function(){$(".collection-watch").change(function(){show_id=$("#show_id").val(),episode_number=$(this).attr("data-episode"),$.post("/api/toggleWatch",{show_id:show_id,episode_number:episode_number}).done(function(a){a.error&&console.log(a.error),1===a.watched?($(this).prop("checked",!0),$("#episode-"+a.episode_number).addClass("info")):($(this).prop("checked",!1),$("#episode-"+a.episode_number).removeClass("info"))})}),$(".collection-season-watch").click(function(){show_id=$("#show_id").val(),season_number=$(this).attr("data-season");var a=[];$(".season-"+season_number).each(function(){a.push($(this).attr("data-episode"))}),$.post("/api/toggleWatch",{show_id:show_id,episode_number:a}).done(function(b){if(b.error&&console.log(b.error),1===b.watched)for($(".season-"+season_number).each(function(){$(this).prop("checked",!0)});a.length>0;)$("#episode-"+a.pop()).addClass("info")})}),$(".collection-show-watch").click(function(){for(var a=$("#show_id").val(),b=parseInt($("#season_count").text()),c=[],d="",e=1;b>=e;e++)d=10>e?".season-0"+e:".season-"+e,$(d).each(function(){c.push($(this).attr("data-episode"))});$.post("/api/toggleWatch",{show_id:a,episode_number:c}).done(function(a){if(a.error&&console.log(a.error),1===a.watched)for($(d).each(function(){$(this).prop("checked",!0)});c.length>0;)$("#episode-"+c.pop()).addClass("info")})})});