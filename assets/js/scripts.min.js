function clearInput(){$("#add_show").prop("disabled",!1),$("#show_name").val("")}function formatResult(a){var b='<a href="'+a.link+"\" target='_blank'>"+decodeURI(a.name)+"</a>";return b+="<div class='result-div'>",b+=formatMetaPrices(a),b+=formatMetaSize(a),b+=formatMetaLanguages(a),b+=formatMetaQuality(a),b+="</div>"}function formatMetaPrices(a){var b="";return"undefined"!=typeof a.meta.prices&&(b+="<ul class='result-meta-prices'>","undefined"!=typeof a.meta.prices.sd&&(b+="<li><span class='badge'>SD</span> $"+a.meta.prices.sd+"</li>"),"undefined"!=typeof a.meta.prices.hd&&(b+="<li><span class='badge'>HD</span> $"+a.meta.prices.hd+"</li>"),b+="</ul>"),b}function formatMetaSize(a){var b="";return a.meta.size&&(b+="<p>"+a.meta.size+"</p>"),b}function formatMetaLanguages(a){var b="";return a.meta.languages&&(b+=a.meta.languages.length>0?"<p>"+a.meta.languages.join(", ")+"</p>":"<p>No Language Information Provided</p>"),b}function formatMetaQuality(a){var b="";return a.meta.quality&&(b+="<p>Quality: <span class='badge'>"+a.meta.quality+"</span></p>"),b}function displayAlert(a,b){alert='<div class="alert alert-'+a+' alert-dismissible" role="alert">',alert+='<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+b+"</div>",$("#alert-container").html(alert)}$(document).ready(function(){$(document).ajaxError(function(a,b){displayAlert("danger","Oh no! '"+b.responseJSON.error)}),$(document).on("click","#add_show",function(){$("#add_show").prop("disabled",!0),show=$("#show_name").val(),$.post("/api/addShowByName",{show:show}).done(function(a){a.error?displayAlert("warning","Oh no! "+a.error):(0===$(".collection-row").length&&$("#empty_collection").remove(),show=a.show,$newRow=$('<tr class="collection-row" id="show-'+show.global_id+'"></tr>'),$newNameCol=$('<td class="collection-show-name col-md-11">'+show.name+"</td>"),$newRemoveCol=$('<td class="collection-show-button col-md-1"></td>'),$newRemoveBtn=$('<button class="btn btn-default remove_show" data-show="'+show.global_id+'" data-name="'+show.name+'" role="button">Remove</button>'),$newNameCol.appendTo($newRow),$newRemoveBtn.appendTo($newRemoveCol),$newRemoveCol.appendTo($newRow),$newRow.appendTo("#collection"),displayAlert("success","You've added '"+show.name+"' ("+show.show_id+") to your collection")),clearInput()}).fail(function(){clearInput()})}),$(document).on("click",".remove_show",function(){$(this).prop("disabled",!0),show_id=$(this).attr("data-show"),show_name=$(this).attr("data-name"),$.post("/api/removeShow",{show_id:show_id}).done(function(a){a.error?displayAlert("warning","Oh no! "+a.error):"OK"==a.status&&($("#show-"+show_id).remove(),0===$(".collection-row").length&&$('<tr id="empty_collection"><td class="col-md-12" colspan="2"><i>You have no shows in your collection.</i></td></tr>').appendTo("#collection"),displayAlert("success","You've removed '"+show_name+"' ("+show_id+") from your collection"))})})}),$(document).ready(function(){$(".acquire-episode").click(function(){var a=$(this).attr("data-provider"),b=$(this).attr("data-id"),c=$(this).attr("data-ep-name"),d=$(this);$.get("/api/findShowURLs",{provider:a,episode:b,ep_name:c}).done(function(a){if(a.error&&console.log(a.error),console.log(a.results.suggestions),0!=a.results.suggestions.length){var b=[];b.push(formatResult(a.results.suggestions[0],0)),d.parent().html(b.join("<br>")),b+="<p>"+a.results.results.length+" more results</p>"}else d.parent().html("No results found")})})}),$(document).ready(function(){$(".collection-watch").change(function(){show_id=$("#show_id").val(),episode_number=$(this).attr("data-episode"),$.post("/api/toggleWatch",{show_id:show_id,episode_number:episode_number}).done(function(a){a.error&&console.log(a.error),1===a.watched?($(this).prop("checked",!0),$("#episode-"+a.episode_number).addClass("info")):($(this).prop("checked",!1),$("#episode-"+a.episode_number).removeClass("info"))})}),$(".collection-season-watch").click(function(){show_id=$("#show_id").val(),season_number=$(this).attr("data-season");var a=[];$(".season-"+season_number).each(function(){1!=$(this).prop("disabled")&&a.push($(this).attr("data-episode"))}),$.post("/api/toggleWatch",{show_id:show_id,episode_number:a}).done(function(b){if(b.error&&console.log(b.error),1===b.watched)for($(".season-"+season_number).each(function(){1!=$(this).prop("disabled")&&$(this).prop("checked",!0)});a.length>0;)$("#episode-"+a.pop()).addClass("info")})}),$(".collection-show-watch").click(function(){for(var a=$("#show_id").val(),b=parseInt($("#season_count").text()),c=[],d="",e=1;b>=e;e++)d=10>e?".season-0"+e:".season-"+e,$(d).each(function(){1!=$(this).prop("disabled")&&c.push($(this).attr("data-episode"))});$.post("/api/toggleWatch",{show_id:a,episode_number:c}).done(function(a){if(a.error&&console.log(a.error),1===a.watched)for($(d).each(function(){1!=$(this).prop("disabled")&&$(this).prop("checked",!0)});c.length>0;)$("#episode-"+c.pop()).addClass("info")})})});